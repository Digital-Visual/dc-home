!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=0)}([function(e,t,n){e.exports=n(1)},function(e,t,n){!function(){var e=!1;if(!DC)throw new Error("missing dc sdk");DC.init((function(){!e&&n(2),e=!0}))}()},function(e,t,n){"use strict";n.r(t);var r=window.DC.getNamespace().Cesium;function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}DC.GlobeRotate=function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;i(this,e),this._viewer=t,this._time=r,this._callback=o,this._startRotate();var a=setTimeout((function(){n._endRotate(),n._callback&&n._callback(),clearTimeout(a)}),1e3*Number(this._time))}var t,n,a;return t=e,(n=[{key:"_icrf",value:function(e,t){if(e.mode===r.SceneMode.SCENE3D){var n=r.Transforms.computeIcrfToFixedMatrix(t);if(r.defined(n)){var i=this._viewer.delegate.camera,o=r.Cartesian3.clone(i.position),a=r.Matrix4.fromRotationTranslation(n);i.lookAtTransform(a,o)}}}},{key:"_startRotate",value:function(){this._viewer.delegate.camera.lookAtTransform(r.Matrix4.IDENTITY),this._viewer.delegate.clock.multiplier=12e3,this._viewer.delegate.scene.postUpdate.addEventListener(this._icrf,this)}},{key:"_endRotate",value:function(){this._viewer.delegate.camera.lookAtTransform(r.Matrix4.IDENTITY),this._viewer.delegate.clock.multiplier=1,this._viewer.delegate.clock.currentTime=r.JulianDate.now().clone(),this._viewer.delegate.scene.postUpdate.removeEventListener(this._icrf,this)}}])&&o(t.prototype,n),a&&o(t,a),e}();var u={resolution:1,material:new r.PolylineGlowMaterialProperty({glowPower:.1,color:r.Color.YELLOW}),width:10};function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}DC.Roaming=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._viewer=t,this._positions=[],this._modelPath=n.modelPath,this._modelScale=n.modelScale||1,this._modelShow=n.modelShow||!0,this._time=n.time||360,this._startTime=void 0,this._endTime=void 0,this._showPath=n.showPath||!1,this._delegate=new r.Entity,this._perspective=n.perspective||0,this._parsePositions(n.positions)}var t,n,i;return t=e,(n=[{key:"_parsePositions",value:function(e){if("string"==typeof e){if(e.indexOf("#")>=0)throw new Error("the positions invalid");e=e.split(";")}this._positions=e.map((function(e){return Array.isArray(e)?DC.Position.fromCoordArray(e):DC.Position.fromCoordString(e)}))}},{key:"_preparePositionProperty",value:function(){var e=this,t=new r.SampledPositionProperty;if(this._positions.length){var n=this._time-this._time%this._positions.length;this._startTime=r.JulianDate.now();var i=n/this._positions.length;this._endTime=r.JulianDate.addSeconds(this._startTime,n,new r.JulianDate),this._positions.forEach((function(n,o){var a=r.JulianDate.addSeconds(e._startTime,o*i,new r.JulianDate);t.addSample(a,DC.T.transformWSG84ToCartesian(n))}))}return t}},{key:"_prepareDelegate",value:function(){var e=this._preparePositionProperty();this._delegate.merge({position:e,orientation:new r.VelocityOrientationProperty(e),model:{uri:this._modelPath,scale:this._modelScale,show:this._modelShow},path:s({},u,{show:this._showPath})}),this._startTime&&this._endTime&&(this._delegate.availability=new r.TimeIntervalCollection([new r.TimeInterval({start:this._startTime,stop:this._endTime})])),this._delegate.position.setInterpolationOptions({interpolationDegree:5,interpolationAlgorithm:r.LagrangePolynomialApproximation})}},{key:"_setClock",value:function(){this._viewer.delegate.clock.startTime=this._startTime.clone(),this._viewer.delegate.clock.stopTime=this._endTime.clone(),this._viewer.delegate.clock.currentTime=this._startTime.clone(),this._viewer.delegate.clock.clockRange=r.ClockRange.UNBOUNDED}},{key:"setSpeed",value:function(e){this._viewer.delegate.clock.multiplier=e}},{key:"setPerspective",value:function(e){this._perspective=e,this._delegate.model&&(0===e?this._viewer.delegate.trackedEntity=this._delegate:1===e&&(this._viewer.delegate.trackedEntity=void 0,this._viewer.delegate.zoomTo(this._delegate,new r.HeadingPitchRange(0,r.Math.toRadians(-90)))))}},{key:"reset",value:function(){this._prepareDelegate(),this._setClock(),this._viewer.delegate.clock.multiplier=1}},{key:"start",value:function(){this._viewer.delegate.entities.remove(this._delegate),this._prepareDelegate(),this._setClock(),this._viewer.delegate.entities.add(this._delegate)}},{key:"stop",value:function(){this._viewer.delegate.entities.remove(this._delegate),this._viewer.delegate.clock.multiplier=1,this._viewer.delegate.trackedEntity=void 0}}])&&c(t.prototype,n),i&&c(t,i),e}();var f=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._viewer=t.viewer,this._handler=t.handler,this._plotEvent=t.plotEvent,this._layer=t.layer,this._delegate=new r.Entity}var t,n,i;return t=e,(n=[{key:"_bindEvent",value:function(){var e=this;this._handler.setInputAction((function(t){e._mouseClickHandler&&e._mouseClickHandler(t)}),r.ScreenSpaceEventType.LEFT_CLICK),this._handler.setInputAction((function(t){e._mouseMoveHandler&&e._mouseMoveHandler(t)}),r.ScreenSpaceEventType.MOUSE_MOVE),this._handler.setInputAction((function(t){e._mouseDbClickHandler&&e._mouseDbClickHandler(t)}),r.ScreenSpaceEventType.LEFT_DOUBLE_CLICK)}},{key:"_unbindEnvet",value:function(){this._handler.removeInputAction(r.ScreenSpaceEventType.LEFT_CLICK),this._handler.removeInputAction(r.ScreenSpaceEventType.MOUSE_MOVE),this._handler.removeInputAction(r.ScreenSpaceEventType.LEFT_DOUBLE_CLICK)}},{key:"_prepareDelegate",value:function(){}},{key:"start",value:function(){this._bindEvent(),this._prepareDelegate()}}])&&p(t.prototype,n),i&&p(t,i),e}();function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t){return!t||"object"!==h(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var w={pixelSize:10,outlineColor:r.Color.BLUE,outlineWidth:5},O=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=d(this,g(t).call(this,e)))._position=r.Cartesian3.ZERO,i._style=_({},w,{},n),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(t,e),n=t,(i=[{key:"_mouseClickHandler",value:function(e){this._position=this._viewer.delegate.scene.camera.pickEllipsoid(e.position,r.Ellipsoid.WGS84),this._unbindEnvet(),this._plotEvent.raiseEvent({type:DC.OverlayType.POINT,points:[DC.T.transformCartesianToWSG84(this._position)]})}},{key:"_mouseMoveHandler",value:function(e){this._viewer.tooltip.setContent("单击选择点位"),this._position=this._viewer.delegate.scene.camera.pickEllipsoid(e.endPosition,r.Ellipsoid.WGS84),this._viewer.tooltip.setPosition(this._position)}},{key:"_prepareDelegate",value:function(){var e=this;this._delegate.position=new r.CallbackProperty((function(t){return e._position})),this._delegate.point=_({},this._style),this._layer.entities.add(this._delegate)}}])&&b(n.prototype,i),o&&b(n,o),t}(f);function E(e){return(E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){C(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function C(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function j(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function S(e,t){return!t||"object"!==E(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function D(e){return(D=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function T(e,t){return(T=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var A={width:3,material:r.Color.BLUE.withAlpha(.6)},W=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=S(this,D(t).call(this,e)))._tempLine=new r.Entity,i._positions=[],i._tempPoints=[],i._style=k({},A,{},n),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&T(e,t)}(t,e),n=t,(i=[{key:"_mouseClickHandler",value:function(e){var t=this._viewer.delegate.scene.camera.pickEllipsoid(e.position,r.Ellipsoid.WGS84);t&&this._positions.push(t)}},{key:"_mouseMoveHandler",value:function(e){this._viewer.tooltip.setContent("单击选择点位,双击结束");var t=this._viewer.delegate.scene.camera.pickEllipsoid(e.endPosition,r.Ellipsoid.WGS84);this._viewer.tooltip.setPosition(t),t&&this._positions.length>0&&(this._viewer.tooltip.setPosition(t),this._tempPoints=[this._positions[this._positions.length-1],t])}},{key:"_mouseDbClickHandler",value:function(e){this._unbindEnvet(),this._positions.length>2&&(this._positions=this._positions.slice(0,-1)),this._plotEvent.raiseEvent({type:DC.OverlayType.POLYLINE,points:DC.T.transformCartesianArrayToWSG84Array(this._positions)})}},{key:"_prepareDelegate",value:function(){var e=this;this._delegate.polyline=k({positions:new r.CallbackProperty((function(t){return e._positions}))},this._style),this._tempLine.polyline=k({positions:new r.CallbackProperty((function(t){return e._tempPoints}))},this._style),this._layer.entities.add(this._delegate),this._layer.entities.add(this._tempLine)}}])&&j(n.prototype,i),o&&j(n,o),t}(f);function L(e){return(L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function R(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){H(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function H(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function G(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function I(e,t){return!t||"object"!==L(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function J(e){return(J=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function N(e,t){return(N=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var U={material:r.Color.BLUE.withAlpha(.6)},B=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=I(this,J(t).call(this,e)))._hierarchy=new r.PolygonHierarchy,i._positions=[],i._tempPoints=[],i._style=M({},U,{},n),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&N(e,t)}(t,e),n=t,(i=[{key:"_mouseClickHandler",value:function(e){var t=this._viewer.delegate.scene.camera.pickEllipsoid(e.position,r.Ellipsoid.WGS84);t&&(2===this._positions.length&&(this._delegate.polyline.show=!1),this._positions.push(t),this._hierarchy.positions=this._positions)}},{key:"_mouseMoveHandler",value:function(e){this._viewer.tooltip.setContent("单击选择点位,双击结束");var t=this._viewer.delegate.scene.camera.pickEllipsoid(e.endPosition,r.Ellipsoid.WGS84);this._viewer.tooltip.setPosition(t),t&&this._positions.length>0&&(this._tempPoints=[this._positions[this._positions.length-1],t],this._hierarchy.positions=[].concat(R(this._positions),[t]))}},{key:"_mouseDbClickHandler",value:function(e){this._unbindEnvet(),this._positions.length>2&&(this._positions=this._positions.slice(0,-1)),this._plotEvent.raiseEvent({type:DC.OverlayType.POLYGON,points:DC.T.transformCartesianArrayToWSG84Array(this._positions)})}},{key:"_prepareDelegate",value:function(){var e=this;this._delegate.polygon=M({hierarchy:new r.CallbackProperty((function(t){return e._hierarchy}))},this._style),this._delegate.polyline=M({positions:new r.CallbackProperty((function(t){return e._tempPoints}))},this._style),this._layer.entities.add(this._delegate)}}])&&G(n.prototype,i),o&&G(n,o),t}(f);function V(e){return(V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(n),!0).forEach((function(t){Z(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Z(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function K(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function z(e,t){return!t||"object"!==V(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function q(e){return(q=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Q(e,t){return(Q=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var X={width:3,material:r.Color.BLUE.withAlpha(.6)},$=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=z(this,q(t).call(this,e)))._center=r.Cartesian3.ZERO,i._radius=0,i._style=F({},X,{},n),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Q(e,t)}(t,e),n=t,(i=[{key:"_mouseClickHandler",value:function(e){var t=this._viewer.delegate.scene.camera.pickEllipsoid(e.position,r.Ellipsoid.WGS84);t&&this._center===r.Cartesian3.ZERO?this._center=t:(this._computeRadius(this._center,t),this._unbindEnvet(),this._plotEvent.raiseEvent({type:DC.OverlayType.CIRCLE,points:[DC.T.transformCartesianToWSG84(this._center)],radius:this._radius}))}},{key:"_mouseMoveHandler",value:function(e){this._viewer.tooltip.setContent("单击选择点位");var t=this._viewer.delegate.scene.camera.pickEllipsoid(e.endPosition,r.Ellipsoid.WGS84);this._viewer.tooltip.setPosition(t),t&&this._center!==r.Cartesian3.ZERO&&this._computeRadius(this._center,t)}},{key:"_computeRadius",value:function(e,t){var n=r.Cartographic.fromCartesian(e),i=r.Cartographic.fromCartesian(t),o=new r.EllipsoidGeodesic;o.setEndPoints(n,i);var a=o.surfaceDistance;this._radius=Math.sqrt(Math.pow(a,2)+Math.pow(i.height-n.height,2))}},{key:"_prepareDelegate",value:function(){var e=this;this._delegate.position=new r.CallbackProperty((function(t){return e._center})),this._delegate.ellipse=F({semiMajorAxis:new r.CallbackProperty((function(t){return e._radius})),semiMinorAxis:new r.CallbackProperty((function(t){return e._radius}))},this._style),this._delegate.point={pixelSize:10,outlineColor:r.Color.RED,outlineWidth:3},this._layer.entities.add(this._delegate)}}])&&K(n.prototype,i),o&&K(n,o),t}(f);function ee(e){return(ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function te(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(n),!0).forEach((function(t){ie(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ie(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function oe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ae(e,t){return!t||"object"!==ee(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function se(e){return(se=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function le(e,t){return(le=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ce={material:r.Color.BLUE.withAlpha(.6)},ue=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=ae(this,se(t).call(this,e)))._coordinates=new r.Rectangle,i._positions=[],i._style=re({},ce,{},n),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&le(e,t)}(t,e),n=t,(i=[{key:"_mouseClickHandler",value:function(e){var t=this._viewer.delegate.scene.camera.pickEllipsoid(e.position,r.Ellipsoid.WGS84);t&&(this._positions.push(t),2===this._positions.length&&(this._coordinates=r.Rectangle.fromCartesianArray(this._positions,r.Ellipsoid.WGS84),this._unbindEnvet(),this._plotEvent.raiseEvent({type:DC.OverlayType.RECT,points:DC.T.transformCartesianArrayToWSG84Array(this._positions)})))}},{key:"_mouseMoveHandler",value:function(e){this._viewer.tooltip.setContent("单击选择点位");var t=this._viewer.delegate.scene.camera.pickEllipsoid(e.endPosition,r.Ellipsoid.WGS84);t&&(this._viewer.tooltip.setPosition(t),this._coordinates=r.Rectangle.fromCartesianArray([].concat(te(this._positions),[t]),r.Ellipsoid.WGS84))}},{key:"_prepareDelegate",value:function(){var e=this;this._delegate.rectangle=re({coordinates:new r.CallbackProperty((function(t){return e._coordinates}))},this._style),this._layer.entities.add(this._delegate)}}])&&oe(n.prototype,i),o&&oe(n,o),t}(f);function pe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function he(e){return(he="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ye(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _e(e,t){return!t||"object"!==he(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ve(e){return(ve=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function be(e,t){return(be=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}DC.Plot=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._viewer=t,this._plotEvent=new r.Event,this._handler=new r.ScreenSpaceEventHandler(this._viewer.canvas),this._callback=void 0,this._drawWorker=void 0,this._editWorker=void 0,this._layer=new r.CustomDataSource("dc-plot"),this._viewer.delegate&&this._viewer.delegate.dataSources.add(this._layer)}var t,n,i;return t=e,(n=[{key:"_completeCallback",value:function(e){this._drawWorker=void 0,this._viewer.tooltip.enable=!1,this._layer.entities.removeAll(),this._callback&&this._callback.call(this,e)}},{key:"_bindEvent",value:function(e){this._plotEvent.removeEventListener(this._completeCallback,this),this._callback=e,this._plotEvent.addEventListener(this._completeCallback,this)}},{key:"_createDrawWorker",value:function(e,t){var n={viewer:this._viewer,handler:this._handler,plotEvent:this._plotEvent,layer:this._layer};e===DC.OverlayType.POINT?this._drawWorker=new O(n,t):e===DC.OverlayType.POLYLINE?this._drawWorker=new W(n,t):e===DC.OverlayType.POLYGON?this._drawWorker=new B(n,t):e===DC.OverlayType.CIRCLE?this._drawWorker=new $(n,t):e===DC.OverlayType.RECT&&(this._drawWorker=new ue(n,t))}},{key:"_createEditWorker",value:function(e){this._viewer,this._handler,this._plotEvent,this._layer}},{key:"draw",value:function(e,t,n){this._viewer.tooltip.enable=!0,this._bindEvent(t),this._createDrawWorker(e,n),this._drawWorker.start()}},{key:"edit",value:function(e,t){this._bindEvent(callback)}}])&&pe(t.prototype,n),i&&pe(t,i),e}();var de=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=_e(this,ve(t).call(this)))._registerEvent(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&be(e,t)}(t,e),n=t,(i=[{key:"_registerEvent",value:function(){for(var e in DC.MouseEventType){var t=DC.MouseEventType[e];this._eventCache[t]=new r.Event}for(var n in DC.OverlayEventType){var i=DC.OverlayEventType[n];this._eventCache[i]=new r.Event}}}])&&ye(n.prototype,i),o&&ye(n,o),t}(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._eventCache={}}var t,n,r;return t=e,(n=[{key:"_registerEvent",value:function(){}},{key:"_on",value:function(e,t,n){var r=this.getEvent(e);t&&r&&r.addEventListener(t,n||this)}},{key:"_off",value:function(e,t,n){var r=this.getEvent(e);t&&r&&r.removeEventListener(t,n||this)}},{key:"_fire",value:function(e,t){var n=this.getEvent(e);n&&n.raiseEvent(t)}},{key:"on",value:function(e,t,n){return this._on(e,t,n),this}},{key:"off",value:function(e,t,n){return this._off(e,t,n),this}},{key:"fire",value:function(e,t){return this._fire(e,t),this}},{key:"getEvent",value:function(e){return this._eventCache[e]||void 0}}])&&fe(t.prototype,n),r&&fe(t,r),e}());function ge(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var me=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._id=DC.Util.uuid(),this._layer=void 0,this._state=void 0,this._delegate=void 0,this._show=!0,this._style={},this._attr={},this._overlayEvent=new de,this._overlayEvent.on(DC.OverlayEventType.ADD,this._addCallback,this),this._overlayEvent.on(DC.OverlayEventType.REMOVE,this._removeCallback,this),this.type=void 0}var t,n,r;return t=e,(n=[{key:"_prepareDelegate",value:function(){}},{key:"_addCallback",value:function(e){this._layer=e,this._prepareDelegate(),this._layer&&this._layer.delegate&&this._layer.delegate.entities&&(this._layer.delegate.entities.add(this._delegate),this._state=DC.OverlayState.ADDED)}},{key:"_removeCallback",value:function(){this._layer&&this._layer.delegate&&this._layer.delegate.entities&&(this._layer.delegate.entities.remove(this._delegate),this._state=DC.OverlayState.REMOVED)}},{key:"setStyle",value:function(e){}},{key:"remove",value:function(){this._layer&&this._layer.layerEvent.fire(DC.LayerEventType.REMOVE_OVERLAY,this)}},{key:"on",value:function(e,t,n){return this._overlayEvent.on(e,t,n||this),this}},{key:"off",value:function(e,t,n){return this._overlayEvent.off(e,t,n||this),this}},{key:"fire",value:function(e,t){return this._overlayEvent.fire(e,t),this}},{key:"id",get:function(){return this._id}},{key:"show",set:function(e){this._show=e,this._delegate&&(this._delegate.show=this._show)},get:function(){return this._show}},{key:"attr",set:function(e){this._attr=e},get:function(){return this._attr}},{key:"overlayEvent",get:function(){return this._overlayEvent}},{key:"delegate",get:function(){return this._delegate}},{key:"state",get:function(){return this._state}}])&&ge(t.prototype,n),r&&ge(t,r),e}();function we(e){return(we="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Oe(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Pe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ke(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ce(e,t){return!t||"object"!==we(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function je(e){return(je=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Se(e,t){return(Se=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function De(e){return(De="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Te(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ae(e,t){return!t||"object"!==De(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function We(e){return(We=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Le(e,t){return(Le=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}DC.Polygon=function(e){function t(e){var n;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),!e||"string"!=typeof e&&!Array.isArray(e))throw new Error("the positions invalid");return(n=Ce(this,je(t).call(this)))._positions=[],n._holes=[],n._preparePositions(e),n._delegate=new r.Entity,n._state=DC.OverlayState.INITIALIZED,n.type=DC.OverlayType.POLYGON,n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Se(e,t)}(t,e),n=t,o=[{key:"fromEntity",value:function(e){}}],(i=[{key:"_preparePositions",value:function(e){if("string"==typeof e){if(e.indexOf("#")>=0)throw new Error("the positions invalid");e=e.split(";")}this._positions=e.map((function(e){return Array.isArray(e)?DC.Position.fromCoordArray(e):DC.Position.fromCoordString(e)}))}},{key:"_prepareHierarchy",value:function(){var e=new r.PolygonHierarchy;return e.positions=DC.T.transformWSG84ArrayToCartesianArray(this._positions),e.holes=this._holes.map((function(e){return new r.PolygonHierarchy(DC.T.transformWSG84ArrayToCartesianArray(e))})),e}},{key:"_prepareDelegate",value:function(){var e=this;this._delegate.polygon=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ee(Object(n),!0).forEach((function(t){Pe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},this._style,{hierarchy:new r.CallbackProperty((function(t){return e._prepareHierarchy()}))}),this._delegate.layer=this._layer,this._delegate.overlayId=this._id}},{key:"setExtrudedHeight",value:function(e,t){if(this._delegate.polygon){var n=r.JulianDate.now(),i=this._delegate.polygon.extrudedHeight?this._delegate.polygon.extrudedHeight.getValue(n):0,o=0,a=n;t&&(o=(e-i)/t,a=DC.JulianDate.addSeconds(n,t,new r.JulianDate)),this._delegate.polygon.extrudedHeight=new r.CallbackProperty((function(n){return r.JulianDate.greaterThan(a,n)?i+(t-r.JulianDate.secondsDifference(a,n))*o:e}))}return this}},{key:"setStyle",value:function(e){if(e&&0!==Object.keys(e).length)return this._style=e,this._delegate.polygon&&this._delegate.polygon.merge(e),this}},{key:"positions",set:function(e){this._preparePositions(e)},get:function(){return this._positions}},{key:"holes",set:function(e){var t=this;e&&e.length&&(this._holes=e.map((function(e){return t._preparePositions(e)})))},get:function(){return this._holes}},{key:"center",get:function(){var e=r.BoundingSphere.fromPoints(DC.T.transformWSG84ArrayToCartesianArray(this._positions));return DC.T.transformCartesianToWSG84(e.center)}},{key:"area",get:function(){var e=0;if(this._positions){var t=0,n=r.Ellipsoid.WGS84,i=Oe(this._positions);i.push(i[0]);for(var o=1;o<i.length;o++){var a=n.cartographicToCartesian(DC.T.transformWSG84ToCartographic(i[o-1])),s=n.cartographicToCartesian(DC.T.transformWSG84ToCartographic(i[o]));t+=a.x*s.y-s.x*a.y}e=Math.abs(t).toFixed(2)}return e}}])&&ke(n.prototype,i),o&&ke(n,o),t}(me),DC.CustomPolygon=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Ae(this,We(t).call(this,e)))._topOutline=void 0,n._bottomOutline=void 0,n._topOutline=new r.Entity({polyline:{positions:n._computePolylinePositions(0)},show:!1}),n._bottomOutline=new r.Entity({polyline:{positions:n._computePolylinePositions(0)},show:!1}),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Le(e,t)}(t,DC.Polygon),n=t,(i=[{key:"_computePolylinePositions",value:function(e){var t=this._positions.slice(0);return t.push(t[0]),t.forEach((function(t){t.alt=e})),DC.T.transformWSG84ArrayToCartesianArray(t)}},{key:"_addCallback",value:function(e){this._layer=e,this._prepareDelegate(),this._layer&&this._layer.delegate&&this._layer.delegate.entities&&(this._layer.delegate.entities.add(this._delegate),this._layer.delegate.entities.add(this._topOutline),this._layer.delegate.entities.add(this._bottomOutline),this._state=DC.OverlayState.ADDED)}},{key:"_removeCallback",value:function(){this._layer&&this._layer.delegate&&this._layer.delegate.entities&&(this._layer.delegate.entities.remove(this._delegate),this._layer.delegate.entities.remove(this._topOutline),this._layer.delegate.entities.remove(this._bottomOutline),this._state=DC.OverlayState.REMOVED)}},{key:"setExtrudedHeight",value:function(e,t){var n=this;if(this._delegate.polygon){var i=r.JulianDate.now(),o=this._delegate.polygon.extrudedHeight?this._delegate.polygon.extrudedHeight.getValue(i):0,a=0,s=i;t&&(a=(e-o)/t,s=DC.JulianDate.addSeconds(i,t,new r.JulianDate)),this._delegate.polygon.extrudedHeight=new r.CallbackProperty((function(n){return r.JulianDate.greaterThan(s,n)?o+(t-r.JulianDate.secondsDifference(s,n))*a:e})),this._topOutline&&this._topOutline.show&&(this._topOutline.polyline.positions=new r.CallbackProperty((function(i){return r.JulianDate.greaterThan(s,i)?n._computePolylinePositions(o+(t-r.JulianDate.secondsDifference(s,i))*a):n._computePolylinePositions(e)})))}return this}},{key:"setTopOutline",value:function(e){return this._topOutline&&(this._topOutline.show=!0,this._topOutline.polyline.merge(e)),this}},{key:"setBottomOutline",value:function(e){return this._bottomOutline&&(this._bottomOutline.show=!0,this._bottomOutline.polyline.merge(e)),this}},{key:"show",set:function(e){this._show=e,this._delegate&&(this._delegate.show=e),this._topOutline&&(this._topOutline.show=e),this._bottomOutline&&(this._bottomOutline=e)},get:function(){return this._show}}])&&Te(n.prototype,i),o&&Te(n,o),t}()}]);